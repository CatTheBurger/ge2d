var GE2D_GL=[],GE2D_CANVAS=[],GE2D_RECT="GE2D-RECT",GE2D_CIRCLE="GE2D-CIRCLE",GE2D_IMAGE="GE2D-IMAGE",GRAPHICS_2D="2d",GRAPHICS_WEBGL="gl",GE_Speaker=function(a){this.lang=void 0===a?"ru-RU":a;this.text="\u041f\u0440\u0438\u0432\u0435\u0442!";this.engine=speechSynthesis};GE_Speaker.prototype.speak=function(a){this.text=a;this.engine.speak(new SpeechSynthesisUtterance(this.text.toString()))};GE_Speaker.prototype.setLang=function(a){this.lang=a};
var GE_Keyboard=function(){this.isDown;this.isUp},GE_KEYBOARD_CONFIG={DOWN:0,UP:0};window.addEventListener("keydown",function(a){GE_KEYBOARD_CONFIG.DOWN=a.key},!1);window.addEventListener("keyup",function(a){GE_KEYBOARD_CONFIG.DOWN=0;GE_KEYBOARD_CONFIG.UP=a.key},!1);GE_Keyboard.prototype.downKey=function(){return this.isDown=GE_KEYBOARD_CONFIG.DOWN};GE_Keyboard.prototype.upKey=function(){return this.isUp=GE_KEYBOARD_CONFIG.UP};
var GE_Camera=function(){this.y=this.x=0;this.viewer=void 0},GE2D_CAMERA_DATA={x:0,y:0};GE_Camera.prototype.move=function(a,b){this.x+=a;this.y+=b;GE2D_CAMERA_DATA.x=this.x;GE2D_CAMERA_DATA.y=this.y};GE_Camera.prototype.moveByAngle=function(a,b,c){};GE_Camera.prototype.setPosition=function(a,b){this.x=a;this.y=b};GE_Camera.prototype.setView=function(a){void 0===this.viewer?a["static"]=!0:this.viewer["static"]=!1;this.viewer=a};
var GE_Shape=function(){this.y=this.x=0;this.h=this.w=10;this.dy=this.dx=0;this.fc="black";this.sc;this.r=10;this.show=!0;this.statis=!1;this.layer=0;this.lineWidth=3;this.angle=0};GE_Shape.prototype.rotate=function(a){};GE_Shape.prototype.move=function(a,b){this.x+=a;this.y+=b;this.dx=a;this.dy=b};GE_Shape.prototype.moveAngle=function(a,b,c){};GE_Shape.prototype.setLayer=function(a){this.layer=a};var GE_Audio=function(a,b){this.src=a.toString();this.repeat=void 0===b?!1:b;this.audio=new Audio(this.src)};
GE_Audio.prototype.play=function(){this.audio.loop=this.repeat;this.audio.play()};GE_Audio.prototype.pause=function(){this.audio.pause()};GE_Audio.prototype.stop=function(){};var GE_Mouse=function(){this.x;this.y;this.pressedButton=0},GE2D_MOUSE_DATA={x:0,y:0,cb:0};window.addEventListener("mousemove",function(a){GE2D_MOUSE_DATA.x=a.pageX;GE2D_MOUSE_DATA.y=a.pageY},!1);window.addEventListener("mousedown",function(a){GE2D_MOUSE_DATA.bc=a.which},!1);
window.addEventListener("mouseup",function(a){GE2D_MOUSE_DATA.bc=0},!1);GE_Mouse.prototype.xPos=function(){return this.x=GE2D_MOUSE_DATA.x};GE_Mouse.prototype.yPos=function(){return this.y=GE2D_MOUSE_DATA.y};GE_Mouse.prototype.down=function(){return this.pressedButton=GE2D_MOUSE_DATA.bc};GE_Mouse.prototype.clickTo=function(a){return this.pressedButton=GE2D_MOUSE_DATA.bc};var GE_Touch=function(){},GE2D_TOUCH_DATA={x:0,y:0,c:0};
window.addEventListener("touchmove",function(a){GE2D_TOUCH_DATA.x=a.touches[0].clientX;GE2D_TOUCH_DATA.y=a.touches[0].clientY},!1);window.addEventListener("touchstart",function(a){GE2D_TOUCH_DATA.c=1},!1);window.addEventListener("touchend",function(a){GE2D_TOUCH_DATA.c=0},!1);GE_Touch.prototype.xPos=function(){return this.x=GE2D_TOUCH_DATA.x};GE_Touch.prototype.yPos=function(){return this.y=GE2D_TOUCH_DATA.y};GE_Touch.prototype.down=function(){return this.pressedButton=GE2D_MOUSE_DATA.c};
GE_Touch.prototype.clickTo=function(a){return this.pressedButton=GE2D_MOUSE_DATA.bc};
var GE_Game=function(){this.FPS=30;this.loop_;this.speaker=new GE_Speaker;this.Rect=function(a,b,c,d,e,f){e=void 0===e?"black":e;GE_Shape.call(this);this.x=a;this.y=b;this.w=c;this.h=d;this.fc=e;this.sc=f;this.type=GE2D_RECT};this.Circle=function(a,b,c,d,e){d=void 0===d?"black":d;GE_Shape.call(this);this.x=a;this.y=b;this.r=c;this.fc=d;this.sc=e;this.type=GE2D_CIRCLE};this.Image=function(a,b,c,d,e){c=void 0===c?100:c;d=void 0===d?100:d;GE_Shape.call(this);this.x=a;this.y=b;this.w=c;this.h=d;this.src=
e;this.type=GE2D_IMAGE};this.Rect.prototype.__proto__=GE_Shape.prototype;this.Circle.prototype.__proto__=GE_Shape.prototype;this.Image.prototype.__proto__=GE_Shape.prototype;this.Keyboard=new GE_Keyboard;this.Camera=new GE_Camera;this.Mouse=new GE_Mouse;this.Touch=new GE_Touch;this.Audio=function(a,b){this.src=a.toString();this.repeat=void 0===b?!1:b;this.audio=new Audio(this.src)};this.Audio.prototype.play=function(){this.audio.loop=this.repeat;this.audio.play()};this.Audio.prototype.pause=function(){this.audio.pause()};
this.Audio.prototype.stop=function(){}};GE_Game.prototype.loop=function(a){this.loop_=setInterval(a,1E3/this.FPS)};GE_Game.prototype.loopFPS=function(a){this.FPS=a};GE_Game.prototype.loopStop=function(){clearInterval(this.loop_)};
var GE_display=function(){this.r=0;this.g=2;this.a=this.b=1;this.Layer=function(a){this.zIndex=a;this["new"]=function(){GE2D_CANVAS.push(document.createElement("canvas"));document.body.appendChild(GE2D_CANVAS.pop());console.log(GE2D_GL.pop())}};this.BoxCollider=function(a,b){this.r1=a;this.r2=b};this.BoxCollider.prototype.is=function(){var a=!1;-GE2D_CAMERA_DATA.x+this.r1.x>this.r2.x-this.r2.w&&-GE2D_CAMERA_DATA.x+this.r1.x<this.r2.x+this.r2.w&&-GE2D_CAMERA_DATA.y+this.r1.y>this.r2.y-this.r2.h&&-GE2D_CAMERA_DATA.y+
this.r1.y<this.r2.y+this.r2.h&&(a=!0);return a}};GE_display.prototype.clear=function(a){a=void 0===a?0:a;GE2D_GL[a].clearRect(0,0,GE2D_CANVAS[a].w,GE2D_CANVAS[a].h)};
GE_display.prototype.draw=function(a){switch(a.type){case GE2D_RECT:0!==a.angle&&GE2D_GL[a.layer].save();if(a["static"]){var b=a.x+a.w/2;var c=a.y+a.h/2}else b=-GE2D_CAMERA_DATA.x+(a.x+a.w/2),c=-GE2D_CAMERA_DATA.y+(a.y+a.h/2);0!==a.angle&&(GE2D_GL[a.layer].translate(b,c),GE2D_GL[a.layer].rotate(a.angle),GE2D_GL[a.layer].translate(-b,-c));a["static"]?(b=a.x,c=a.y):(b=-GE2D_CAMERA_DATA.x+a.x,c=-GE2D_CAMERA_DATA.y+a.y);void 0!==a.fc&&(GE2D_GL[a.layer].fillStyle=a.fc,GE2D_GL[a.layer].fillRect(b,c,a.w,
a.h));void 0!==a.sc&&(GE2D_GL[a.layer].strokeStyle=a.sc,GE2D_GL[a.layer].lineWidth=a.lineWidth,GE2D_GL[a.layer].strokeRect(b,c,a.w,a.h));0!==a.angle&&GE2D_GL[a.layer].restore();break;case GE2D_IMAGE:0!==a.angle&&GE2D_GL[a.layer].save();a["static"]?(b=a.x+a.w/2,c=a.y+a.h/2):(b=-GE2D_CAMERA_DATA.x+(a.x+a.w/2),c=-GE2D_CAMERA_DATA.y+(a.y+a.h/2));0!==a.angle&&(GE2D_GL[a.layer].translate(b,c),GE2D_GL[a.layer].rotate(a.angle),GE2D_GL[a.layer].translate(-b,-c));a["static"]?(b=a.x,c=a.y):(b=-GE2D_CAMERA_DATA.x+
a.x,c=-GE2D_CAMERA_DATA.y+a.y);var d=new Image;d.src=a.src;GE2D_GL[a.layer].drawImage(d,b,c,a.w,a.h);0!==a.angle&&GE2D_GL[a.layer].restore();break;case GE2D_CIRCLE:a["static"]?(b=a.x,c=a.y):(b=-GE2D_CAMERA_DATA.x+a.x,c=-GE2D_CAMERA_DATA.y+a.y);GE2D_GL[a.layer].beginPath();GE2D_GL[a.layer].arc(b,c,a.r,0,2*Math.PI,!1);void 0!==a.fc&&(GE2D_GL[a.layer].fillStyle=a.fc,GE2D_GL[a.layer].fill());void 0!==a.sc&&(GE2D_GL[a.layer].strokeStyle=a.sc,GE2D_GL[a.layer].lineWidth=a.lineWidth,GE2D_GL[a.layer].stroke());
break;default:console.log("Undefined shape type!")}};GE_display.prototype.background=function(a){GE2D_CANVAS[0].style.background=a.toString()};GE_display.prototype.backgroundImage=function(a){GE2D_CANVAS[0].style.backgroundImage="url("+a.toString()+")";GE2D_CANVAS[0].style.backgroundRepeat="norepeat"};GE_display.prototype.rotation=function(a){return a/180*Math.PI};
var App=function(a,b,c){c=void 0===c?"2d":c;this.width=void 0===a?500:a;this.height=void 0===b?400:b;this.title="ge2d engine!";this.webgl_contexts=["webgl","experimental-webgl","moz-webgl","webkit-3d"];this.errors=["webgl-context-error!","Undefined shape type!"];this.messages=["webgl-context is defined!","webgl setuped!"];this.canvas=[];this.context=[];this.canvas.push(document.createElement("canvas"));document.body.appendChild(this.canvas[0]);this.canvas[0].width=this.width;this.canvas[0].height=
this.height;GE2D_CANVAS.push({w:this.width,h:this.height});c!==GRAPHICS_WEBGL&&c===GRAPHICS_2D&&(this.context.push(this.canvas[0].getContext("2d")),console.log(this.context[0]));console.log(c);GE2D_GL.push(this.context[0]);this.Game=new GE_Game;this.display=new GE_display};